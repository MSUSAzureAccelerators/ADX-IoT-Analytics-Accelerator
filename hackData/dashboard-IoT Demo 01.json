{"$schema":"https://dataexplorer.azure.com/static/d/schema/24/dashboard.json","id":"474edab9-00cf-4b9e-b785-8669b90c01e4","eTag":"tlGeKEmGoL1ksIZXlPWJkw==","schema_version":"24","title":"IoT Demo 01","pages":[{"name":"Page 1","id":"f6e6c3ad-3945-4d72-a2b8-41ef270f1c84"}],"tiles":[{"id":"34159cf8-442e-4d8b-a935-08332a4397ee","title":"Average Temp by Device","query":"// Please enter your KQL query (Example):\n// TableName | take 10\nThermostats\n| where EnqueuedTimeUTC between (startTime .. endTime)\n| where DeviceId == Device_Id\n| summarize avg(Temp) by bin(EnqueuedTimeUTC,1m)\n| render timechart ","layout":{"x":0,"y":0,"width":24,"height":7},"pageId":"f6e6c3ad-3945-4d72-a2b8-41ef270f1c84","visualType":"timechart","dataSourceId":"e3b5b1f3-9572-45f3-989d-56b8f2300a76","usedParamVariables":["startTime","endTime","Device_Id"],"visualOptions":{}},{"id":"e0642811-9e53-4ec5-9e93-90ba3bc65315","title":"Is there any missing data at 1 min bin?","query":"//Is there any missing data? \n//make-series\n//Create series of specified aggregated values along specified axis.\nThermostats\n| where EnqueuedTimeUTC between (startTime .. endTime)\n| where DeviceId == Device_Id\n| make-series AvgTemp=avg(Temp) on EnqueuedTimeUTC step 1m   \n| render timechart ","layout":{"x":0,"y":7,"width":24,"height":7},"pageId":"f6e6c3ad-3945-4d72-a2b8-41ef270f1c84","visualType":"timechart","dataSourceId":"e3b5b1f3-9572-45f3-989d-56b8f2300a76","usedParamVariables":["startTime","endTime","Device_Id"],"visualOptions":{"yAxisMinimumValue":{"type":"infer"},"yAxisMaximumValue":{"type":"infer"},"multipleYAxes":{"base":{"id":"-1","columns":[],"label":"","yAxisMinimumValue":null,"yAxisMaximumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]}}},{"id":"8b6b05f9-ff1d-4efd-b7f9-7821e4e884df","title":"Trend with linear interpolation of missing values in a series","query":"//How can I fill the missing values?\n//series_fill_linear()\n//Performs linear interpolation of missing values in a series.\nThermostats\n| where EnqueuedTimeUTC between (startTime .. endTime)\n| where DeviceId == Device_Id\n| make-series AvgTemp=avg(Temp) default=real(null) on EnqueuedTimeUTC step 1m   \n| extend NoGapsAvgTemp=series_fill_linear(AvgTemp)\n| project EnqueuedTimeUTC, NoGapsAvgTemp\n| render timechart ","layout":{"x":0,"y":14,"width":24,"height":7},"pageId":"f6e6c3ad-3945-4d72-a2b8-41ef270f1c84","visualType":"timechart","dataSourceId":"e3b5b1f3-9572-45f3-989d-56b8f2300a76","usedParamVariables":["startTime","endTime","Device_Id"],"visualOptions":{"yAxisMinimumValue":{"type":"infer"},"yAxisMaximumValue":{"type":"infer"},"multipleYAxes":{"base":{"id":"-1","columns":[],"label":"","yAxisMinimumValue":null,"yAxisMaximumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]}}},{"id":"a4cb6662-f330-4bec-ab56-46bc4aa8a035","title":"Forecasting the next 15min by Time Series Decomposition","query":"//What will be the temprature for next one hour?\nThermostats\n| where EnqueuedTimeUTC between (startTime .. endTime)\n| where DeviceId == Device_Id\n| make-series AvgTemp=avg(Temp) default=real(null) on EnqueuedTimeUTC from ago(5h) to now()+15m step 1m    \n| extend NoGapsAvgTemp=series_fill_linear(AvgTemp)\n| project EnqueuedTimeUTC, NoGapsAvgTemp\n| extend forecast = series_decompose_forecast(NoGapsAvgTemp, 15)\n| render timechart with(title='Forecasting the next 15min by Time Series Decmposition')\n","layout":{"x":0,"y":21,"width":9,"height":7},"pageId":"f6e6c3ad-3945-4d72-a2b8-41ef270f1c84","visualType":"timechart","dataSourceId":"e3b5b1f3-9572-45f3-989d-56b8f2300a76","usedParamVariables":["startTime","endTime","Device_Id"],"visualOptions":{"yAxisMinimumValue":{"type":"infer"},"yAxisMaximumValue":{"type":"infer"},"multipleYAxes":{"base":{"id":"-1","columns":[],"label":"","yAxisMinimumValue":null,"yAxisMaximumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]}}},{"id":"79a1f212-9417-41ef-a4c0-832ba6887a2f","title":"Anomalies by Device","query":"//Are there any anomalies for this device?\nThermostats\n| where EnqueuedTimeUTC between (startTime .. endTime)\n| where DeviceId == Device_Id\n| make-series AvgTemp=avg(Temp) default=real(null) on EnqueuedTimeUTC step 1m   \n| extend NoGapsAvgTemp=series_fill_linear(AvgTemp)\n| project EnqueuedTimeUTC, NoGapsAvgTemp\n| extend anomalies = series_decompose_anomalies(NoGapsAvgTemp,1) \n| render anomalychart with(anomalycolumns=anomalies)","layout":{"x":9,"y":21,"width":15,"height":7},"pageId":"f6e6c3ad-3945-4d72-a2b8-41ef270f1c84","visualType":"anomalychart","dataSourceId":"e3b5b1f3-9572-45f3-989d-56b8f2300a76","usedParamVariables":["startTime","endTime","Device_Id"],"visualOptions":{"yAxisMinimumValue":{"type":"infer"},"yAxisMaximumValue":{"type":"infer"},"multipleYAxes":{"base":{"id":"-1","columns":[],"label":"","yAxisMinimumValue":null,"yAxisMaximumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]}}},{"id":"501eeee2-e68e-458b-acf6-9ae404885147","title":"AllAnomalies","query":"//What the anomalies I shoudl focus on across all devices?\nThermostats\n| where EnqueuedTimeUTC > ago(7d)\n| make-series AvgTemp=avg(Temp) default=real(null) on EnqueuedTimeUTC from ago(5h) to now() step 1m by DeviceId\n| extend NoGapsTemp=series_fill_linear(AvgTemp)\n| project EnqueuedTimeUTC, DeviceId, NoGapsTemp\n| extend anomalies = series_decompose_anomalies(NoGapsTemp, 1)\n| mv-expand EnqueuedTimeUTC, anomalies, NoGapsTemp\n| where anomalies == 1","layout":{"x":0,"y":28,"width":9,"height":7},"pageId":"f6e6c3ad-3945-4d72-a2b8-41ef270f1c84","visualType":"table","dataSourceId":"e3b5b1f3-9572-45f3-989d-56b8f2300a76","usedParamVariables":[],"visualOptions":{}}],"parameters":[{"kind":"duration","id":"c3ddff10-0097-42ec-b587-d06e863830d9","displayName":"Time range","beginVariableName":"startTime","endVariableName":"endTime","defaultValue":{"kind":"dynamic","count":24,"unit":"hours"},"showOnPages":{"kind":"all"}},{"kind":"string","id":"f1b332cb-bae4-45a6-a057-4049b8432fe2","selectionType":"single","variableName":"Device_Id","displayName":"DeviceId","defaultValue":{"kind":"value","value":"637085868243706792"},"dataSource":{"kind":"query","consumedVariables":[],"query":"// Please enter your KQL query (Example):\n// TableName | take 10\nThermostats\n| distinct DeviceId\n| order by DeviceId asc ","dataSourceId":"e3b5b1f3-9572-45f3-989d-56b8f2300a76","columns":{}},"showOnPages":{"kind":"all"}}],"dataSources":[{"id":"e3b5b1f3-9572-45f3-989d-56b8f2300a76","name":"demo12.westus","scopeId":"kusto","kind":"manual-kusto","clusterUri":"https://demo12.westus.kusto.windows.net/","database":"Occupancy"}]}